@using Microsoft.AspNetCore.Identity;
@inject SignInManager<User> signInManager;

@model PatientDashboardVM

@{
    ViewData["Title"] = "Patient dashboard";
    Layout = "~/Views/Shared/_PatientLayout.cshtml";
}



<div class="dash-body" style="margin-top: 15px">
    <table border="0" width="100%" style="border-spacing: 0; margin: 0; padding: 0;">
        <tr>
            <td colspan="1" class="nav-bar">
                <p style="font-size: 23px; padding-left: 12px; font-weight: 600; margin-left: 20px;">Home</p>
            </td>
            <td width="25%"></td>
            <td width="15%">
                <p style="font-size: 14px; color: rgb(119, 119, 119); padding: 0; margin: 0; text-align: right;">
                    Today's Date
                </p>
                <p class="heading-sub12" style="padding: 0; margin: 0;">
                    @DateTime.Now
                </p>
            </td>
            <td width="10%">
                <button class="btn-label" style="display: flex; justify-content: center; align-items: center;">
                    <img src="~/img/calendar.svg" width="100%">
                </button>
            </td>
        </tr>
        <tr>
            <td colspan="4">
                <center>
                    <table class="filter-container doctor-header patient-header" style="border: none; width: 95%"
                        border="0">
                        <tr>
                            <td>
                                <h3>Welcome!</h3>
                                <h1>
                                    @Model.FirstName
                                </h1>
                                <p>Haven't any idea about doctors? no problem let's jumping to
                                    <a href="#" class="non-style-link"><b>"All Doctors"</b></a> section or
                                    <a href="#" class="non-style-link"><b>"Sessions"</b> </a><br>
                                    Track your past and future appointments history.<br>Also find out the expected
                                    arrival time of your doctor or medical consultant.<br><br>
                                </p>

                                <h3>Channel a Doctor Here</h3>
                                <form action="" method="post" style="display: flex">

                                    <input type="search" name="search" class="input-text "
                                        placeholder="Search Doctor and We will Find The Session Available"
                                        list="doctors" style="width:45%;">&nbsp;&nbsp;

                                    <datalist id="doctors">
                                        @foreach (var doctor in Model.Doctors)
                                        {
                                            <option value="@doctor" />

                                            <br />
                                        }
                                    </datalist>
                                    <input type="Submit" value="Search" class="login-btn btn-primary btn"
                                        style="padding-left: 25px;padding-right: 25px;padding-top: 10px;padding-bottom: 10px;">

                                </form>
                                <br>
                                <br>
                            </td>
                        </tr>
                        <!-- ... (other content) ... -->
                    </table>
                </center>
            </td>
        </tr>
        <tr>
            <td colspan="4">
                <table border="0" width="100%">
                    <tr>
                        <td width="50%">
                            <center>
                                <table class="filter-container" style="border: none;" border="0">
                                    <tr>
                                        <td colspan="4">
                                            <p style="font-size: 20px;font-weight:600;padding-left: 12px;">Status
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width: 25%;">
                                            <div class="dashboard-items"
                                                style="padding:20px;margin:auto;width:95%;display: flex">
                                                <div>
                                                    <div class="h1-dashboard">
                                                        @Model.Doctors.Count()
                                                    </div><br>
                                                    <div class="h3-dashboard">
                                                        All Doctors &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                    </div>
                                                </div>
                                                <div class="btn-icon-back dashboard-icons"
                                                    style="background-image: url('../img/icons/doctors-hover.svg');">
                                                </div>
                                            </div>
                                        </td>
                                        <td style="width: 25%;">
                                            <div class="dashboard-items"
                                                style="padding:20px;margin:auto;width:95%;display: flex;">
                                                <div>
                                                    <div class="h1-dashboard">
                                                        @Model.Patients.Count()
                                                    </div><br>
                                                    <div class="h3-dashboard">
                                                        All Patients &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                    </div>
                                                </div>
                                                <div class="btn-icon-back dashboard-icons"
                                                    style="background-image: url('../img/icons/patients-hover.svg');">
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width: 25%;">
                                            <div class="dashboard-items"
                                                style="padding:20px;margin:auto;width:95%;display: flex; ">
                                                <div>
                                                    <div class="h1-dashboard">
                                                        @Model.Appointments.Count()
                                                    </div><br>
                                                    <div class="h3-dashboard">
                                                        NewBooking &nbsp;&nbsp;
                                                    </div>
                                                </div>
                                                <div class="btn-icon-back dashboard-icons"
                                                    style="margin-left: 0px;background-image: url('../img/icons/book-hover.svg');">
                                                </div>
                                            </div>

                                        </td>

                                        <td style="width: 25%;">
                                            <div class="dashboard-items"
                                                style="padding:20px;margin:auto;width:95%;display: flex;padding-top:21px;padding-bottom:21px;">
                                                <div>
                                                    <div class="h1-dashboard">
                                                        @Model.Appointments.Count()
                                                    </div><br>
                                                    <div class="h3-dashboard" style="font-size: 15px">
                                                        Today Sessions
                                                    </div>
                                                </div>
                                                <div class="btn-icon-back dashboard-icons"
                                                    style="background-image: url('../img/icons/session-iceblue.svg');">
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <!-- ... (other content) ... -->
                                </table>
                            </center>
                        </td>
                        <td>
                            <p style="font-size: 20px; font-weight: 600; padding-left: 40px;" class="anime">Your
                                Upcoming
                                Booking
                            </p>
                            <center>
                                <div class="abc scroll" style="height: 250px; padding: 0; margin: 0;">
                                    <table width="85%" class="sub-table scrolldown" border="0">
                                        <thead>

                                            <tr>
                                                <th class="table-headin">


                                                    Appoint. Number

                                                </th>
                                                <th class="table-headin">


                                                    Session Title

                                                </th>

                                                <th class="table-headin">
                                                    Doctor
                                                </th>
                                                <th class="table-headin">

                                                    Sheduled Date & Time

                                                </th>

                                            </tr>
                                        </thead>
                                        <tbody>
                                            @{
                                                // Assuming 'today' and 'userid' are variables available in the Razor
                                                var today = DateTime.Now.ToString("yyyy-MM-dd");
                                                var nextWeek = DateTime.Now.AddDays(7).ToString("yyyy-MM-dd");

                                                // Replace the following with your actual data access logic
                                                var appointments = Model.Appointments;
                                            }

                                            @if (appointments.Count == 0)
                                            {
                                                <tr>
                                                    <td colspan="4">
                                                        <br /><br /><br /><br />
                                                        <center>
                                                            <img src="~/img/notfound.svg" width="25%" />

                                                            <br />
                                                            <p class="heading-main12"
                                                                style="margin-left: 45px; font-size: 20px; color: rgb(49, 49, 49)">
                                                                Nothing to show here!
                                                            </p>
                                                            <a class="non-style-link" href="schedule">
                                                                <button class="login-btn btn-primary-soft btn"
                                                                    style="display: flex; justify-content: center; align-items: center; margin-left: 20px;">
                                                                    &nbsp; Channel a Doctor &nbsp;
                                                                </button>
                                                            </a>
                                                        </center>
                                                        <br /><br /><br /><br />
                                                    </td>
                                                </tr>
                                            }
                                            else
                                            {
                                                @for (int i = 0; i < appointments.Count; i++)
                                                {
                                                    var appointment = appointments[i];
                                                    var doctor = Model.Doctors[i];

                                                    <tr>
                                                        <td style="padding:30px; font-size:25px; font-weight:700;"> &nbsp;
                                                            @appointment.AppointmentNumber </td>
                                                        <td style="padding:20px;"> &nbsp; @appointment.Title.Substring(0,
                                                    30) </td>
                                                        <td> @doctor.FirstName.Substring(0, 20) </td>
                                                        <td style="text-align:center;">
                                                            @appointment.AppointmentDate.ToString()
                                                            @appointment.AppointmentTime.ToString()
                                                        </td>
                                                    </tr>
                                                }
                                            }

                                        </tbody>
                                    </table>
                                </div>
                            </center>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</div>